<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–ì—Ä–∞—Ñ–∏–∫ —Å–º–µ–Ω</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: sans-serif;
      background: #f2f2f2;
    }
    header {
      background: #4caf50;
      color: #fff;
      padding: 16px;
      text-align: center;
    }
    main {
      max-width: 700px;
      margin: 0 auto;
      padding: 16px;
    }
    h1, h2 {
      margin-top: 0;
    }
    .card {
      background: #fff;
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 24px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    /* –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–º–µ–Ω */
    #shiftForm {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: flex-end;
      margin-bottom: 16px;
    }
    #shiftForm label {
      display: flex;
      flex-direction: column;
      font-weight: bold;
      font-size: 0.9rem;
    }
    #shiftForm input, #shiftForm select {
      margin-top: 4px;
      padding: 8px;
      font-size: 1rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      min-width: 120px;
    }
    #shiftForm button {
      background: #4caf50;
      color: #fff;
      border: none;
      padding: 10px 16px;
      font-size: 1rem;
      border-radius: 4px;
      cursor: pointer;
    }
    #shiftForm button:hover {
      background: #45a049;
    }

    .table-responsive {
      width: 100%;
      overflow-x: auto;
    }
    table {
      min-width: 600px;
      border-collapse: collapse;
      width: 100%;
    }
    thead {
      background: #ddd;
    }
    th, td {
      padding: 8px;
      border: 1px solid #ccc;
      text-align: left;
      font-size: 0.95rem;
    }
    tr:nth-child(even) {
      background: #f9f9f9;
    }
    .done-row td {
      text-decoration: line-through;
      color: #999;
    }
    .btn {
      padding: 6px 12px;
      font-size: 0.9rem;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin-right: 4px;
    }
    .btn.done {
      background: #ffc107; /* –ñ—ë–ª—Ç–∞—è */
      color: #000;
    }
    .btn.edit {
      background: #2196f3;
      color: #fff;
    }
    .btn.delete {
      background: #f44336;
      color: #fff;
    }
    .btn:hover {
      opacity: 0.9;
    }
    .modal-overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.5);
      display: none; 
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
    .modal {
      background: #fff;
      padding: 16px;
      border-radius: 8px;
      max-width: 400px;
      width: 100%;
      position: relative;
    }
    .modal h2 {
      margin-top: 0;
    }
    .modal form {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .close-modal {
      position: absolute;
      top: 8px;
      right: 8px;
      background: transparent;
      border: none;
      font-size: 1.2rem;
      cursor: pointer;
      color: #333;
    }

    /* –§–æ—Ä–º–∞ —Ä–∞—Å—á—ë—Ç–∞ –∑–∞—Ä–ø–ª–∞—Ç—ã */
	#salaryForm {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    #salaryForm label {
      font-weight: bold;
    }
    #salaryResult {
      margin-top: 16px;
      padding: 12px;
      background: #f9f9f9;
      border: 1px solid #ddd;
      border-radius: 8px;
      display: none;
    }
    #salaryResult p {
      margin: 4px 0;
    }

    @media (max-width: 480px) {
      #shiftForm {
        flex-direction: column;
      }
      #shiftForm label, #shiftForm input, #shiftForm select, #shiftForm button {
        width: 100%;
      }
      table {
        min-width: 500px;
      }
    }

.btn-salary {
  background: #4caf50;
  color: white;
  border: none;
  padding: 10px 16px;
  font-size: 1rem;
  border-radius: 4px;
  cursor: pointer;
  display: block;
  margin-top: 10px;
  width: 100%;
}

.btn-salary:hover {
  background: #45a049;
}
/* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–æ—Ä–º—ã —Ä–∞—Å—á–µ—Ç–∞ –∑–∞—Ä–ø–ª–∞—Ç—ã */
#salaryForm {
  display: flex;
  flex-direction: column; /* –≠–ª–µ–º—Ç—ã –∏–¥—É—Ç –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ */
  align-items: center; /* –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ —Ü–µ–Ω—Ç—Ä—É */
  text-align: center; /* –í—ã—Ä–∞–≤–≤–∞–µ–º —Ç–µ–∫—Å—Ç */
}

/* –£–º–µ–Ω—å—à–∞–µ–º —à–∏—Ä–∏–Ω—É –ø–æ–ª—è –≤–≤–æ–¥–∞ –∏ –∫–Ω–æ–ø–∫–∏ */
#hourlyRate {
  width: 50%; /* –î–µ–ª–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞ —É–∂–µ */
  min-width: 200px; /* –ú–∏–Ω–∏—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ */
}

/* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –∫–Ω–æ–ø –∏ –¥–µ–ª–∞–µ–º –µ–µ —É–∂–µ */
.btn-salary {
  width: 25%; /* –°—É–∂–∞–µ–º –∫–Ω–æ–ø–∫—É */
  min-width: 150px; /* –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ */
  padding: 8px 12px; /* –î–µ–ª–∞–µ–º –∫–Ω–æ–ø–∫—É –∫–æ–º–ø–∞–∫—Ç–Ω–µ–µ */
  font-size: 0.9rem; /* –ß—É—Ç—å —É–º–µ–Ω—å—à–∞–µ–º —Ç–µ–∫—Å—Ç */
}


@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@100;200;300;400;500;600;700&display=swap');

:root {
    --calendar-bg-color: #faf8f7;
    --calendar-font-color: #050505;
    --weekdays-border-bottom-color: #404040;
    --calendar-date-hover-color: #505050;
    --calendar-current-date-color: #dbdad9;
    --calendar-today-color: linear-gradient(to bottom, #d9d9d9, #d9d9d9);
    --calendar-today-innerborder-color: transparent;
    --calendar-nextprev-bg-color: transparent;
    --next-prev-arrow-color : red;
    --calendar-border-radius: 16px;
    --calendar-prevnext-date-color: #d1cecd
}

* {
    padding: 0;
    margin: 0;
}

.calendar {
    font-family: 'IBM Plex Sans', sans-serif;
    position: relative;
    max-width: 400px; /*change as per your design need */
    min-width: 320px;
    background: var(--calendar-bg-color);
    color: var(--calendar-font-color);
    margin: 20px auto;
    box-sizing: border-box;
    overflow: hidden;
    font-weight: normal;
    border-radius: var(--calendar-border-radius);
}

.calendar-inner {
    padding: 10px 10px;
}

.calendar .calendar-inner .calendar-body {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    text-align: center;
    
}

.calendar .calendar-inner .calendar-body div {
    padding: 4px;
    min-height: 30px;
    line-height: 30px;
    border: 1px solid transparent;
    margin: 10px 2px 0px;
    
}

/* –ö—Ä–∞—Å–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –°–± –∏ –í—Å */
.calendar .calendar-inner .calendar-body div:nth-child(6),
.calendar .calendar-inner .calendar-body div:nth-child(7) {
    color: red !important;
    
}

/* –ö—Ä–∞—Å–Ω—ã–µ —Ü–∏—Ñ—Ä—ã –≤ –∫–æ–ª–æ–Ω–∫–∞—Ö —Å—É–±–±–æ—Ç—ã –∏ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å—è */
.calendar .calendar-inner .calendar-body div:nth-child(7n-1) a, /* –°—É–±–±–æ—Ç–∞ */
.calendar .calendar-inner .calendar-body div:nth-child(7n) a {  /* –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ */
    color: red !important;
    
}

.calendar .calendar-inner .calendar-body div>a {
    color: var(--calendar-font-color);
    text-decoration: none;
    display: flex;
    justify-content: center;

}

.calendar .calendar-inner .calendar-body div:hover {
    border: 1px solid var(--calendar-date-hover-color);
    border-radius: 4px;
    
}

.calendar .calendar-inner .calendar-body div.empty-dates:hover {
    border: 1px solid transparent;
    
}

.calendar .calendar-inner .calendar-controls {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
}

.calendar .calendar-inner .calendar-today-date {
    display: grid;
    text-align: center;
    cursor: pointer;
    margin: 3px 0px;
    background: var(--calendar-current-date-color);
    padding: 8px 0px;
    border-radius: 10px;
    width: 80%;
    margin: auto;
    
}

.calendar .calendar-inner .calendar-controls .calendar-year-month {
    display: flex;
    min-width: 100px;
    justify-content: space-evenly;
    align-items: center;
}

.calendar .calendar-inner .calendar-controls .calendar-next {
    text-align: right;
}

.calendar .calendar-inner .calendar-controls .calendar-year-month .calendar-year-label,
.calendar .calendar-inner .calendar-controls .calendar-year-month .calendar-month-label {
    font-weight: 500;
    font-size: 20px;
}

.calendar .calendar-inner .calendar-body .calendar-today {
    background: var(--calendar-today-color);
    border-radius: 4px;
    
}

.calendar .calendar-inner .calendar-body .calendar-today:hover {
    border: 1px solid transparent;
    
}

.calendar .calendar-inner .calendar-body .calendar-today a {
    outline: 2px solid var(--calendar-today-innerborder-color);
}

.calendar .calendar-inner .calendar-controls .calendar-next a,
.calendar .calendar-inner .calendar-controls .calendar-prev a {
    color: var(--calendar-font-color);
    font-family: arial, consolas, sans-serif;
    font-size: 26px;
    text-decoration: none;
    padding: 4px 12px;
    display: inline-block;
    background: var(--calendar-nextprev-bg-color);
    margin: 10px 0 10px 0;
}

.calendar .calendar-inner .calendar-controls .calendar-next a svg,
.calendar .calendar-inner .calendar-controls .calendar-prev a svg {
    height: 20px;
    width: 20px;
}

.calendar .calendar-inner .calendar-controls .calendar-next a svg path,
.calendar .calendar-inner .calendar-controls .calendar-prev a svg path{
    fill: var(--next-prev-arrow-color);
}

.calendar .calendar-inner .calendar-body .prev-dates,
.calendar .calendar-inner .calendar-body .next-dates {
    color: var(--calendar-prevnext-date-color);
}

.calendar .calendar-inner .calendar-body .prev-dates:hover,
.calendar .calendar-inner .calendar-body .next-dates:hover {
  border: 1px solid transparent;
  pointer-events: none;
  
}
.shift-day {
    background-color: rgba(0, 200, 0, 0.5);
    border-radius: 4px;
}

.shift-night {
    background-color: rgba(0, 0, 200, 0.5);
    border-radius: 4px;
    color: white;
}

.shift-holiday-day {
    background-color: rgba(255, 165, 0, 0.5);
    border-radius: 4px;
}

.shift-holiday-night {
    background-color: rgba(200, 0, 0, 0.5);
    border-radius: 4px;
    color: white;
}
  </style>
  <style>
 @keyframes pulse {
  0% { opacity: 0.7; }
  50% { opacity: 1; }
  100% { opacity: 0.7; }
}

.bar-shifts, .bar-hours {
  animation: pulse 1.5s infinite alternate;
}
 .stats-bar {
  display: flex;
  align-items: center;
  margin-bottom: 8px;
}

.stats-label {
  width: 120px;
  font-weight: bold;
}

.stats-bar-container {
  flex: 1;
  height: 20px;
  background: #ddd;
  border-radius: 4px;
  overflow: hidden;
  position: relative;
}

.stats-bar-fill {
  height: 100%;
  text-align: right;
  line-height: 20px;
  padding-right: 8px;
  font-size: 0.9rem;
  color: white;
  font-weight: bold;
  transition: width 0.5s ease-in-out;
}

.bar-shifts {
  background: #4caf50; /* –ó–µ–ª—ë–Ω—ã–π */
}

.bar-hours {
  background: #f44336; /* –ö—Ä–∞—Å–Ω—ã–π */
}

/* –°–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–Ω—ã–µ —Ü–∏—Ñ—Ä—ã –≤ –∫–æ–Ω—Ü–µ –∫–æ–ª–æ–Ω–æ–∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
#statsCount, #statsHours {
  display: none;
}
</style>

<style>
/* –ö–∞—Ä—Ç–æ—á–∫–∞ –¥–ª—è –±–ª–æ–∫–∞ "–ò–º–ø–æ—Ä—Ç –≥—Ä–∞—Ñ–∏–∫–∞" */
.card {
  background: #fff;
  padding: 16px;
  border-radius: 8px;
  margin-bottom: 24px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ */
.card h2 {
  margin-top: 0;
  color: #050505; /* –ó–µ–ª–µ–Ω—ã–π —Ü–≤–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞ */
  font-size: 1.5rem;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è —Ñ–æ—Ä–º—ã */
.card form {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  align-items: flex-end;
}

/* –ü–æ–ª—è –≤–≤–æ–¥–∞ –∏ –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ */
.card input,
.card select {
  padding: 8px;
  font-size: 1rem;
  border: 1px solid #ccc;
  border-radius: 4px;
  min-width: 150px;
}

/* –ó–µ–ª–µ–Ω–∞—è –∫–Ω–æ–ø–∫–∞, –∫–∞–∫ —É "–î–æ–±–∞–≤–∏—Ç—å —Å–º–µ–Ω—É" */
.btn-import {
  background: #4caf50;
  color: white;
  border: none;
  padding: 10px 16px;
  font-size: 1rem;
  border-radius: 4px;
  cursor: pointer;
  transition: background 0.3s;
}

/* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É "–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å" */
.btn-import {
  display: block;
  margin: 10px auto; /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º */
  width: 25%; /* –î–µ–ª–∞–µ–º –∫–Ω–æ–ø–∫—É –∫–æ–º–ø–∞–∫—Ç–Ω–µ–µ */
  min-width: 150px; /* –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ */
  padding: 8px 12px; /* –î–µ–ª–∞–µ–º –∫–Ω–æ–ø–∫—É –º–µ–Ω—å—à–µ */
  font-size: 0.9rem; /* –£–º–µ–Ω—å—à–∞–µ–º —Ç–µ–∫—Å—Ç */
}

.btn-import:hover {
  background: #45a049;
}
/* –°–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ç–µ–∫—Å—Ç –≤–Ω—É—Ç—Ä–∏ input type="file" */
input[type="file"] {
  color: transparent;
}

/* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –±–ª–æ–∫–∏ –∏ –¥–µ–ª–∞–µ–º –ø–æ–ª—è –∫–æ–º–ø–∞–∫—Ç–Ω–µ–µ */
.input-group {
  display: flex;
  flex-direction: column;
  gap: 4px;
  align-items: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ */
  text-align: center;
  width: 100%;
}

/* –£–º–µ–Ω—å—à–∞–µ–º —à–∏—Ä–∏–Ω—É –ø–æ–ª–µ–π */
.input-group input,
.input-group select {
  width: 50%; /* –£–º–µ–Ω—å—à–∞–µ–º —à–∏—Ä–∏–Ω—É */
  min-width: 200px; /* –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ */
  padding: 6px 10px; /* –î–µ–ª–∞–µ–º –ø–æ–ª—è –∫–æ–º–ø–∞–∫—Ç–Ω–µ–µ */
  font-size: 0.9rem; /* –£–º–µ–Ω—å—à–∞–µ–º —à—Ä–∏—Ñ—Ç */
}
.btn-share {
  background: #2196f3;
  color: white;
  border: none;
  padding: 10px 16px;
  font-size: 1rem;
  border-radius: 4px;
  cursor: pointer;
  display: block;
  margin: 10px auto;
}

.btn-share:hover {
  background: #1976d2;
}

#qr-container {
  text-align: center;
  margin-top: 20px;
}

#preview {
  display: block;
  max-width: 100%;
  margin: 15px auto;
  border: 1px solid #ccc;
}
#qr-container {
  display: flex;
  justify-content: center;
  align-items: center;
  margin-top: 20px;
}

#qr-container canvas {
  max-width: 100%;
  height: auto;
}
</style>
<style>
/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ç–∞–±–ª–∏—Ü—ã */
#shiftTableContainer {
  margin-top: 10px;
  padding: 0; /* –£–±–∏—Ä–∞–µ–º –æ—Ç—Å—Ç—É–ø—ã */
  border: 1px solid #ccc;
  background: #f9f9f9;
  border-radius: 5px;
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.5s ease-in-out, padding 0.3s ease-in-out;
}

/* –û—Ç–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ */
#shiftTableContainer.open {
  max-height: 500px; /* –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–º–µ–Ω */
  padding: 10px;
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
.table-responsive {
  width: 100%;
  max-height: 400px; /* –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å–∫—Ä–æ–ª–ª */
  overflow-x: auto; /* –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–∫—Ä–æ–ª–ª */
  overflow-y: auto;
  border: 1px solid #ccc;
  background: white;
  border-radius: 8px;
}

table {
  min-width: 800px; /* –†–∞—Å—à–∏—Ä—è–µ–º —Ç–∞–±–ª–∏—Ü—É */
  width: 100%;
  border-collapse: collapse;
}

th, td {
  padding: 10px;
  border: 1px solid #ccc;
  text-align: left;
}

thead {
  position: sticky;
  top: 0;
  background: #ddd;
  z-index: 2;
}
</style>
<style>
#customAlert {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: #2196f3;
  color: white;
  padding: 10px 20px;
  border-radius: 5px;
  display: none;
  text-align: center;
}

#customAlert.show {
  display: block;
}
</style>
<link rel="manifest" href="/manifest.json">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="–°–º–µ–Ω—ã">
<link rel="apple-touch-icon" href="/icons/icon-192.png">
<link rel="apple-touch-icon" sizes="180x180" href="icons/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="icons/android-icon-192x192.png">
</head>
<body>
  <header>
    <h1>–ì—Ä–∞—Ñ–∏–∫ —Å–º–µ–Ω</h1>
  </header>
  <main>

    <!-- 1) –ö–∞—Ä—Ç–æ—á–∫–∞: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–º–µ–Ω -->
    <div class="card">
      <h2>–î–æ–±–∞–≤–∏—Ç—å —Å–º–µ–Ω—É</h2>
      <form id="shiftForm">
        <label>
          –ù–∞–∑–≤–∞–Ω–∏–µ:
          <input type="text" id="name" placeholder="–ù–æ—á—å –∏–ª–∏ –î–µ–Ω—å" />
        </label>
        <label>
          –î–∞—Ç–∞:
          <input type="date" id="date" required />
        </label>
        <label>
          –ù–∞—á–∞–ª–æ (–≤—Ä–µ–º—è):
          <input type="time" id="startTime" required />
        </label>
        <!-- –¢–∏–ø —Å–º–µ–Ω—ã: –¥–µ–Ω—å, –Ω–æ—á—å, –ø—Ä–∞–∑–¥–Ω–∏–∫(–¥–µ–Ω—å), –ø—Ä–∞–∑–¥–Ω–∏–∫(–Ω–æ—á—å) -->
        <label>
          –¢–∏–ø —Å–º–µ–Ω—ã:
          <select id="shiftType">
            <option value="day">–î–µ–Ω—å (12 —á.)</option>
            <option value="night">–ù–æ—á—å (20 —á.)</option>
            <option value="holidayDay">–ü—Ä–∞–∑–¥–Ω–∏–∫ (–¥–µ–Ω—å) 24 —á.</option>
            <option value="holidayNight">–ü—Ä–∞–∑–¥–Ω–∏–∫ (–Ω–æ—á—å) 24 —á.</option>
          </select>
        </label>
        <!-- –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) -->
        <label>
          –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ (–º–∏–Ω. –¥–æ –Ω–∞—á–∞–ª–∞):
          <input type="number" id="remindBefore" value="30" min="0" />
        </label>

        <button type="submit">–î–æ–±–∞–≤–∏—Ç—å —Å–º–µ–Ω—É</button>
      </form>
    </div>
<!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å) -->
	<div id="calendar"></div>
<div class="calendar"></div>
     <!-- 2) –¢–∞–±–ª–∏—Ü–∞ —Å–º–µ–Ω -->
<div class="card" id="shiftCard">
  <h2 class="clickable">üìÖ –°–ø–∏—Å–æ–∫ —Å–º–µ–Ω</h2>
  <div id="shiftTableContainer" class="hidden">
    <div class="table-responsive">
      <table>
        <thead>
          <tr>
            <th>–ò–º—è</th>
            <th>–î–∞—Ç–∞</th>
            <th>–ù–∞—á–∞–ª–æ</th>
            <th>–¢–∏–ø —Å–º–µ–Ω—ã</th>
            <th>–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ</th>
            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
          </tr>
        </thead>
        <tbody id="shiftsBody">
          <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
        </tbody>
      </table>
    </div>
  </div>
</div>
 <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü -->
     <div class="card">
  <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü</h2>
  
  <div class="stats-bar">
    <span class="stats-label">–°–º–µ–Ω—ã:</span>
    <div class="stats-bar-container">
      <div id="barShifts" class="stats-bar-fill bar-shifts"></div>
    </div>
    <span id="statsCount"></span>
  </div>
  
  <div class="stats-bar">
    <span class="stats-label">–ß–∞—Å—ã:</span>
    <div class="stats-bar-container">
      <div id="barHours" class="stats-bar-fill bar-hours"></div>
    </div>
    <span id="statsHours"></span>
  </div>

</div>
<!-- –ö–Ω–æ–ø–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ -->
<div class="card">
  <h2>–ò–º–ø–æ—Ä—Ç –≥—Ä–∞—Ñ–∏–∫–∞</h2>
  <div class="input-group">
  <label for="uploadSchedule">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª:</label>
  <input type="file" id="uploadSchedule" accept=".ods" />
</div>

    <div class="input-group">
  <label for="employeeSelect">–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞:</label>
  <select id="employeeSelect"></select>
</div>

    <button type="button" id="importShifts" class="btn-import">–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
  </form>
</div>

    <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ —Ä–∞—Å—á—ë—Ç–∞ –∑–∞—Ä–ø–ª–∞—Ç—ã -->
<div class="card">
  <h2>–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –∑–∞—Ä–ø–ª–∞—Ç—É</h2>
  <form id="salaryForm">
    <label for="hourlyRate">–û–∫–ª–∞–¥/—Ç–∞—Ä–∏—Ñ (—Ä—É–±/—á–∞—Å):</label>
    <input type="number" id="hourlyRate" step="0.01" min="0" required />

    <button type="submit" class="btn-salary">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
  </form>
</div>
      <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç -->
      <div id="salaryResult">
        <p><strong>–ò—Ç–æ–≥–æ–≤–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ (–ø–æ—Å–ª–µ –ù–î–§–õ): <span id="finalSalary">0</span> —Ä—É–±.</strong></p>
        <p>–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è:</p>
        <ul>
          <li>–î–Ω–µ–≤–Ω—ã–µ (—Å—É–º–º.—á–∞—Å—ã): <span id="rDayHours"></span> √ó —Å—Ç–∞–≤–∫–∞ = <span id="rDayPay"></span> —Ä—É–±.</li>
          <li>–ù–æ—á–Ω—ã–µ (—Å—É–º–º.—á–∞—Å—ã): <span id="rNightHours"></span> √ó —Å—Ç–∞–≤–∫–∞ = <span id="rNightPay"></span> —Ä—É–±.</li>
          <li>–ü—Ä–∞–∑–¥–Ω–∏–∫ (–¥–µ–Ω—å) (—Å—É–º–º.—á–∞—Å—ã): <span id="rHolDayHours"></span> √ó —Å—Ç–∞–≤–∫–∞ = <span id="rHolDayPay"></span> —Ä—É–±.</li>
          <li>–ü—Ä–∞–∑–¥–Ω–∏–∫ (–Ω–æ—á—å) (—Å—É–º–º.—á–∞—Å—ã): <span id="rHolNightHours"></span> √ó —Å—Ç–∞–≤–∫–∞ = <span id="rHolNightPay"></span> —Ä—É–±.</li>
          <li>–ü—Ä–µ–º–∏—è: <span id="rBonus"></span> —Ä—É–±.</li>
          <li>–î–æ –ù–î–§–õ: <span id="rGross"></span> —Ä—É–±.</li>
          <li>–ù–î–§–õ (13%): <span id="rNdfl"></span> —Ä—É–±.</li>
        </ul>
      </div>
    </div>
	<!-- –°–∫–∞—á–∞—Ç—å —Å–º–µ–Ω—ã -->
<div class="card">
  <h2>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–º–µ–Ω—ã</h2>
  <button class="btn btn-share" id="downloadShifts">üì• –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª</button>
</div>
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
    <div class="modal-overlay" id="modalOverlay">
      <div class="modal" id="editModal">
        <button class="close-modal" id="closeModalBtn">&times;</button>
        <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–º–µ–Ω—É</h2>
        <form id="editForm">
          <label>
            –ò–º—è:
            <input type="text" id="editName" />
          </label>
          <label>
            –î–∞—Ç–∞:
            <input type="date" id="editDate" required />
          </label>
          <label>
            –ù–∞—á–∞–ª–æ (–≤—Ä–µ–º—è):
            <input type="time" id="editStartTime" required />
          </label>
          <label>
            –¢–∏–ø —Å–º–µ–Ω—ã:
            <select id="editShiftType">
              <option value="day">–î–µ–Ω—å (12 —á.)</option>
              <option value="night">–ù–æ—á—å (20 —á.)</option>
              <option value="holidayDay">–ü—Ä–∞–∑–¥–Ω–∏–∫ (–¥–µ–Ω—å) 24 —á.</option>
              <option value="holidayNight">–ü—Ä–∞–∑–¥–Ω–∏–∫ (–Ω–æ—á—å) 24 —á.</option>
            </select>
          </label>
          <label>
            –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ (–º–∏–Ω. –¥–æ –Ω–∞—á–∞–ª–∞):
            <input type="number" id="editRemindBefore" value="30" min="0" />
          </label>
          <button type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </form>
      </div>
    </div>

  <script>
   
  
 // –•—Ä–∞–Ω–∏–ª–∏—â–µ —Å–º–µ–Ω
    let shifts = [];
    let currentEditId = null

    // –°—Å—ã–ª–∫–∏ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç—ã
    const shiftsBody = document.getElementById('shiftsBody');
    const shiftForm = document.getElementById('shiftForm');
    const salaryForm = document.getElementById('salaryForm');
    const salaryResult = document.getElementById('salaryResult');

    // –ú–æ–¥–∞–ª—å–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    const modalOverlay = document.getElementById('modalOverlay');
    const editModal = document.getElementById('editModal');
    const closeModalBtn = document.getElementById('closeModalBtn');
    const editForm = document.getElementById('editForm');

    // –ü–æ–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    const editName = document.getElementById('editName');
    const editDate = document.getElementById('editDate');
    const editStartTime = document.getElementById('editStartTime');
    const editShiftType = document.getElementById('editShiftType');
    const editRemindBefore = document.getElementById('editRemindBefore');

    document.addEventListener("DOMContentLoaded", () => {
      console.log();
      loadShifts();
      renderShiftsTable();
      highlightShiftsInCalendar(); // –í—ã–∑—ã–≤–∞–µ–º –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–º–µ–Ω
       // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –æ—Ñ—Ñ–ª–∞–π–Ω/–æ–Ω–ª–∞–π–Ω —Å–æ—Å—Ç–æ—è–Ω–∏—è
  window.addEventListener("offline", () => {
      alert("‚ö†Ô∏è –í—ã –æ—Ñ—Ñ–ª–∞–π–Ω! –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.");
  });

  window.addEventListener("online", () => {
      alert("‚úÖ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω! –î–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –æ–±–Ω–æ–≤–∏—Ç—å—Å—è.");
  });
});

 // —Å–º–µ–Ω—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å
function saveShiftsToLocalStorage() {
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–º–µ–Ω—ã –≤ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
    localStorage.setItem("shifts", JSON.stringify(shifts));
    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Ç–∞–±–ª–∏—Ü—É —Å–º–µ–Ω)
    renderShiftsTable();
    document.getElementById('shiftForm').reset();
    
}
	  const API_URL = "https://shift-schedule-server-production.up.railway.app/api/shifts";

// üîπ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–º–µ–Ω –≤ localStorage
function saveShiftsLocally(shifts) {
    localStorage.setItem("shifts", JSON.stringify(shifts));
}

// üîπ –ó–∞–≥—Ä—É–∑–∫–∞ —Å–º–µ–Ω –∏–∑ localStorage
function loadShiftsFromLocalStorage() {
    const storedShifts = localStorage.getItem("shifts");
    return storedShifts ? JSON.parse(storedShifts) : [];
}

// üîπ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–º–µ–Ω —Å —Å–µ—Ä–≤–µ—Ä–∞ + –∏–∑ localStorage
async function loadShifts() {
    try {
        const response = await fetch(API_URL);
        const serverShifts = await response.json();
        
        // –û–±—ä–µ–¥–∏–Ω—è–µ–º —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ —Å–º–µ–Ω—ã —Å –ª–æ–∫–∞–ª—å–Ω—ã–º–∏
        let localShifts = loadShiftsFromLocalStorage();
        let mergedShifts = [...serverShifts, ...localShifts];

        // –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ –¥–∞—Ç–µ –∏ —Ç–∏–ø—É
        mergedShifts = mergedShifts.filter((shift, index, self) =>
            index === self.findIndex(s => s.date === shift.date && s.shift === shift.shift)
        );

        saveShiftsLocally(mergedShifts); // –û–±–Ω–æ–≤–ª—è–µ–º localStorage
        renderShifts(mergedShifts); // –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ

    } catch (error) {
        console.error("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å —Å–µ—Ä–≤–µ—Ä–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ", error);
        renderShifts(loadShiftsFromLocalStorage()); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ —Å–º–µ–Ω—ã
    }
}

// üîπ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–º–µ–Ω—ã –≤ localStorage –∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
async function addShift(date, shiftType) {
    const newShift = { date, shift: shiftType };
    let localShifts = loadShiftsFromLocalStorage();
    localShifts.push(newShift);
    saveShiftsLocally(localShifts);
    renderShifts(localShifts); // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

    try {
        const response = await fetch(API_URL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(newShift),
        });

        if (response.ok) {
            console.log("‚úÖ –°–º–µ–Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä!");
        } else {
            console.error("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä:", await response.text());
        }
    } catch (error) {
        console.error("‚ùå –°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —Å–º–µ–Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ.", error);
    }
}

// üîπ –£–¥–∞–ª–µ–Ω–∏–µ —Å–º–µ–Ω—ã
async function deleteShift(shiftId) {
    let localShifts = loadShiftsFromLocalStorage();
    localShifts = localShifts.filter(shift => shift.id !== shiftId);
    saveShiftsLocally(localShifts);
    renderShifts(localShifts); // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É

    try {
        const response = await fetch(`${API_URL}/${shiftId}`, { method: "DELETE" });
        if (response.ok) {
            console.log("‚úÖ –°–º–µ–Ω–∞ —É–¥–∞–ª–µ–Ω–∞ —Å —Å–µ—Ä–≤–µ—Ä–∞!");
        } else {
            console.error("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Å–º–µ–Ω—ã:", await response.text());
        }
    } catch (error) {
        console.error("‚ùå –°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —É–¥–∞–ª—è–µ–º —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ.", error);
    }
}

// üîπ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É
window.addEventListener("online", async () => {
    console.log("üåç –û–Ω–ª–∞–π–Ω! –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ...");
    let localShifts = loadShiftsFromLocalStorage();

    for (const shift of localShifts) {
        try {
            await fetch(API_URL, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(shift),
            });
        } catch (error) {
            console.error("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:", error);
        }
    }
    
    localStorage.removeItem("shifts"); // –û—á–∏—â–∞–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π –∫–µ—à –ø–æ—Å–ª–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
    loadShifts(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
});
// üîπ –ó–∞–ø—É—Å–∫–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É —Å–º–µ–Ω –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
document.addEventListener("DOMContentLoaded", loadShifts);

	  // —Å–º–µ–Ω—ã –ª–æ–∫–∞–ª–∏—Ç–∏
    // –î–ª—è —É–¥–æ–±—Å—Ç–≤–∞: —Å–∫–æ–ª—å–∫–æ —á–∞—Å–æ–≤ –≤ –∫–∞–∂–¥–æ–º —Ç–∏–ø–µ —Å–º–µ–Ω—ã
    function computeHours(shiftType) {
      switch (shiftType) {
        case 'day': return 12;
        case 'night': return 20;
        case 'holidayDay': return 24;   // –¥–µ–Ω—å √ó2
        case 'holidayNight': return 24; // –Ω–æ—á—å √ó2
      }
      return 0;
    }
    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–º–µ–Ω—ã
    shiftForm.addEventListener('submit', e => {
      e.preventDefault();
      const nameVal = document.getElementById('name').value.trim();
      const dateVal = document.getElementById('date').value;
      const startTimeVal = document.getElementById('startTime').value;
      const shiftTypeVal = document.getElementById('shiftType').value;
      const remindBeforeVal = parseInt(document.getElementById('remindBefore').value, 10) || 0;

      if (!dateVal || !startTimeVal || !shiftTypeVal) {
        alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞—Ç—É, –≤—Ä–µ–º—è –∏ —Ç–∏–ø —Å–º–µ–Ω—ã!');
        return;
      }

      const newShift = {
        id: Date.now(),
        name: nameVal,
        date: dateVal,
        startTime: startTimeVal,
        shiftType: shiftTypeVal,
        remindBefore: remindBeforeVal,
        isDone: false
      };

      shifts.push(newShift);
      saveShiftsToLocalStorage();
      renderShiftsTable();
      shiftForm.reset();
    });

   function updateMonthStats() {
  console.log("–§—É–Ω–∫—Ü–∏—è updateMonthStats –≤—ã–∑–≤–∞–Ω–∞!");

  const statsCountEl = document.getElementById('statsCount');
  const statsHoursEl = document.getElementById('statsHours');

  if (!statsCountEl || !statsHoursEl) {
    console.error("‚ùå –û—à–∏–±–∫–∞: –≠–ª–µ–º–µ–Ω—Ç—ã statsCount –∏–ª–∏ statsHours –Ω–µ –Ω–∞–π–¥–µ–Ω—ã!");
    return;
  }

  const now = new Date();
  const currentYear = now.getFullYear();
  const currentMonth = now.getMonth();

  let count = 0;
  let totalHours = 0;

  shifts.forEach(shift => {
    const d = new Date(shift.date + "T00:00:00");
    if (d.getFullYear() === currentYear && d.getMonth() === currentMonth) {
      count++;
      totalHours += computeHours(shift.shiftType);
    }
  });

  statsCountEl.textContent = count;
  statsHoursEl.textContent = totalHours;

  // --- –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–ª–æ—Å–∫–∏ ---
  const barShifts = document.getElementById('barShifts');
  const barHours = document.getElementById('barHours');

  if (barShifts && barHours) {
    console.log("–û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫...");

    const maxShifts = Math.max(20, count);
    const maxHours = Math.max(200, totalHours);

    barShifts.style.width = (count / maxShifts) * 100 + '%';
    barHours.style.width = (totalHours / maxHours) * 100 + '%';

    barShifts.textContent = count;
    barHours.textContent = totalHours;
  } else {
    console.warn("‚ö†Ô∏è –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã!");
  }
}
	function renderShiftsTable() {
      shiftsBody.innerHTML = '';
      shifts.forEach(shift => {
        const tr = document.createElement('tr');
        if (shift.isDone) {
          tr.classList.add('done-row');
        }
        tr.innerHTML = `
          <td>${shift.name || ''}</td>
          <td>${formatDate(shift.date)}</td>
          <td>${shift.startTime}</td>
          <td>${displayShiftType(shift.shiftType)}</td>
          <td>${shift.remindBefore} –º–∏–Ω.</td>
          <td>
            <button class="btn done" data-id="${shift.id}">‚úî</button>
            <button class="btn edit" data-id="${shift.id}">–†–µ–¥.</button>
            <button class="btn delete" data-id="${shift.id}">–£–¥.</button>
          </td>
        `;
		shiftsBody.appendChild(tr);
		updateMonthStats();
      });

      document.querySelectorAll('.btn.done').forEach(btn => {
        btn.addEventListener('click', e => {
          const id = parseInt(e.target.dataset.id, 10);
          toggleDone(id);
        });
      });
      document.querySelectorAll('.btn.edit').forEach(btn => {
        btn.addEventListener('click', e => {
          const id = parseInt(e.target.dataset.id, 10);
          openEditModal(id);
        });
      });
      document.querySelectorAll('.btn.delete').forEach(btn => {
        btn.addEventListener('click', e => {
          const id = parseInt(e.target.dataset.id, 10);
          deleteShift(id);
        });
      });
    }

    // –£–¥–∞–ª–∏—Ç—å —Å–º–µ–Ω—É
    function deleteShift(id) {
      shifts = shifts.filter(s => s.id !== id);
      saveShiftsToLocalStorage();
      renderShiftsTable();
    }

    // –û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ
    function toggleDone(id) {
      const sh = shifts.find(s => s.id === id);
      if (!sh) return;
      sh.isDone = !sh.isDone;
      saveShiftsToLocalStorage();
      renderShiftsTable();
    }

    // –§–æ—Ä–º–∞—Ç —Ç–∏–ø–∞ —Å–º–µ–Ω—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    function displayShiftType(st) {
      switch (st) {
        case 'day': return '–î–µ–Ω—å (12 —á.)';
        case 'night': return '–ù–æ—á—å (20 —á.)';
        case 'holidayDay': return '–ü—Ä–∞–∑–¥–Ω.–¥–µ–Ω—å (24 —á.)';
        case 'holidayNight': return '–ü—Ä–∞–∑–¥–Ω.–Ω–æ—á—å (24 —á.)';
      }
      return st;
    }

    // –§–æ—Ä–º–∞—Ç –¥–∞—Ç—ã (2024-02-12 -> 12.02.2024)
    function formatDate(isoDate) {
      const [y,m,d] = isoDate.split('-');
      return `${d}.${m}.${y}`;
    }

    // –û—Ç–∫—Ä—ã—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    function openEditModal(id) {
      currentEditId = id;
      const shift = shifts.find(s => s.id === id);
      if (!shift) return;

      editName.value = shift.name;
      editDate.value = shift.date;
      editStartTime.value = shift.startTime;
      editShiftType.value = shift.shiftType;
      editRemindBefore.value = shift.remindBefore || 0;

      modalOverlay.style.display = 'flex';
    }

    function closeModal() {
      modalOverlay.style.display = 'none';
    }
    closeModalBtn.addEventListener('click', closeModal);
    modalOverlay.addEventListener('click', e => {
      if (e.target === modalOverlay) {
        closeModal();
      }
    });

    // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
    editForm.addEventListener('submit', e => {
      e.preventDefault();
      if (!currentEditId) return;

      const idx = shifts.findIndex(s => s.id === currentEditId);
      if (idx === -1) return;

      shifts[idx].name = editName.value.trim();
      shifts[idx].date = editDate.value;
      shifts[idx].startTime = editStartTime.value;
      shifts[idx].shiftType = editShiftType.value;
      shifts[idx].remindBefore = parseInt(editRemindBefore.value, 10) || 0;

      saveShiftsToLocalStorage();
      renderShiftsTable();
      closeModal();
    });

    // 4) –†–∞—Å—á—ë—Ç –∑–∞—Ä–ø–ª–∞—Ç—ã
    salaryForm.addEventListener('submit', e => {
      e.preventDefault();

      const hourlyRate = parseFloat(document.getElementById('hourlyRate').value);
      if (isNaN(hourlyRate) || hourlyRate <= 0) {
        alert('–£–∫–∞–∂–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —á–∞—Å–æ–≤—É—é —Å—Ç–∞–≤–∫—É');
        return;
      }

      // 4.1 –°—É–º–º–∏—Ä—É–µ–º —á–∞—Å—ã –ø–æ —Ç–∏–ø–∞–º
      let sumDayHours = 0, sumNightHours = 0, sumHolDayHours = 0, sumHolNightHours = 0;
      // –°—á–∏—Ç–∞–µ–º, —Å–∫–æ–ª—å–∫–æ ¬´—Å–º–µ–Ω¬ª –≤—Å–µ–≥–æ (–¥–ª—è –ø—Ä–µ–º–∏–∏)
      // (–∫–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å –≤ shifts = 1 —Å–º–µ–Ω–∞)
      let totalShiftsCount = shifts.length;

      shifts.forEach(shift => {
        const h = computeHours(shift.shiftType);
        if (shift.shiftType === 'day') sumDayHours += h;
        else if (shift.shiftType === 'night') sumNightHours += h;
        else if (shift.shiftType === 'holidayDay') sumHolDayHours += h;
        else if (shift.shiftType === 'holidayNight') sumHolNightHours += h;
      });

      // 4.2 –°—á–∏—Ç–∞–µ–º –æ–ø–ª–∞—Ç—É (–±–µ–∑ –Ω–∞–¥–±–∞–≤–æ–∫) = (–¥–Ω–µ–≤–Ω—ã–µ + –Ω–æ—á–Ω—ã–µ + –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–µ) * hourlyRate
      const dayPay = sumDayHours * hourlyRate;
      const nightPay = sumNightHours * hourlyRate;
      const holDayPay = sumHolDayHours * hourlyRate;
      const holNightPay = sumHolNightHours * hourlyRate;
      let total = dayPay + nightPay + holDayPay + holNightPay;

      // 4.3 –ù–∞–¥–±–∞–≤–∫–∏:
      // –†–∞–π–æ–Ω–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç +15%
      total *= 1.15;
      // –ö–¢–£ +30%
      total *= 1.30;
      // –í—Ä–µ–¥–Ω–æ—Å—Ç—å +4%
      total *= 1.04;

      // 4.4 –ü—Ä–µ–º–∏—è –æ—Ç –∫–æ–ª-–≤–∞ —Å–º–µ–Ω (14 =>2000, 19 =>4000, 20 =>6000)
      let bonus = 0;
      if (totalShiftsCount >= 20) bonus = 6000;
      else if (totalShiftsCount >= 19) bonus = 4000;
      else if (totalShiftsCount >= 14) bonus = 2000;
      total += bonus;

      // 4.5 –ù–î–§–õ (13%)
      const ndfl = total * 0.13;
      const final = total - ndfl;

      // –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
      document.getElementById('rDayHours').textContent = sumDayHours;
      document.getElementById('rNightHours').textContent = sumNightHours;
      document.getElementById('rHolDayHours').textContent = sumHolDayHours;
      document.getElementById('rHolNightHours').textContent = sumHolNightHours;

      document.getElementById('rDayPay').textContent = dayPay.toFixed(2);
      document.getElementById('rNightPay').textContent = nightPay.toFixed(2);
      document.getElementById('rHolDayPay').textContent = holDayPay.toFixed(2);
      document.getElementById('rHolNightPay').textContent = holNightPay.toFixed(2);

      document.getElementById('rBonus').textContent = bonus.toFixed(2);
      document.getElementById('rGross').textContent = total.toFixed(2);
      document.getElementById('rNdfl').textContent = ndfl.toFixed(2);
      document.getElementById('finalSalary').textContent = final.toFixed(2);

      salaryResult.style.display = 'block';
    });
  </script>
  <script>
  document.addEventListener('DOMContentLoaded', () => {
  const shiftCard = document.getElementById("shiftCard");
  const shiftTableContainer = document.getElementById("shiftTableContainer");

  if (!shiftCard || !shiftTableContainer) {
    console.error("‚ùå –û—à–∏–±–∫–∞: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–º–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω.");
    return;
  }

  shiftCard.addEventListener("click", () => {
    shiftTableContainer.classList.toggle("open");
  });
});
</script>
  </main>
  <script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js')
      .then(() => console.log('Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω!'))
      .catch(error => console.error('–û—à–∏–±–∫–∞ Service Worker:', error));
  }
</script>
<script>
if ("Notification" in window) {
  Notification.requestPermission().then(permission => {
    if (permission === "granted") {
      console.log("–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω—ã");
    } else {
      console.log("–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∑–∞–ø—Ä–µ—â–µ–Ω—ã");
    }
  });
}
</script>

<script>
//check the console for date click event
//Fixed day highlight
//Added previous month and next month view
/* Russian (UTF-8) initialisation for the jQuery UI date picker plugin. */
/* Written by Andrew Stromnov (stromnov@gmail.com). */

function CalendarControl() {
    const calendar = new Date();
    const calendarControl = {
      localDate: new Date(),
      prevMonthLastDate: null,
      calWeekDays: ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"],
      calMonthName: [
        "–Ø–Ω–≤",
        "–§–µ–≤",
        "–ú–∞—Ä",
        "–ê–ø—Ä",
        "–ú–∞–π",
        "–ò—é–Ω",
        "–ò—é–ª",
        "–ê–≤–≥",
        "–°–µ–Ω",
        "–û–∫—Ç",
        "–ù–æ—è",
        "–î–µ–∫"
      ],
      daysInMonth: function (month, year) {
        return new Date(year, month, 0).getDate();
      },
      firstDay: function () {
        return new Date(calendar.getFullYear(), calendar.getMonth(), 1);
      },
      lastDay: function () {
        return new Date(calendar.getFullYear(), calendar.getMonth() + 1, 0);
      },
    
     firstDayNumber: function () {
        return calendarControl.firstDay().getDay() + 0;
     },
     
      lastDayNumber: function () {
        return calendarControl.lastDay().getDay() + 1;
      },
      getPreviousMonthLastDate: function () {
        let lastDate = new Date(
          calendar.getFullYear(),
          calendar.getMonth(),
          0
        ).getDate();
        return lastDate;
      },
      navigateToPreviousMonth: function () {
        calendar.setMonth(calendar.getMonth() - 1);
		highlightShiftsInCalendar();
        calendarControl.attachEventsOnNextPrev();
      },
      navigateToNextMonth: function () {
        calendar.setMonth(calendar.getMonth() + 1);
		
        calendarControl.attachEventsOnNextPrev();
      },
      navigateToCurrentMonth: function () {
        let currentMonth = calendarControl.localDate.getMonth();
        let currentYear = calendarControl.localDate.getFullYear();
        calendar.setMonth(currentMonth);
        calendar.setYear(currentYear);
		
        calendarControl.attachEventsOnNextPrev();
      },
      displayYear: function () {
        let yearLabel = document.querySelector(".calendar .calendar-year-label");
        yearLabel.innerHTML = calendar.getFullYear();
      },
      displayMonth: function () {
        let monthLabel = document.querySelector(
          ".calendar .calendar-month-label"
        );
        monthLabel.innerHTML = calendarControl.calMonthName[calendar.getMonth()];
      },
      selectDate: function (e) {
        console.log(
          `${e.target.textContent} ${
            calendarControl.calMonthName[calendar.getMonth()]
          } ${calendar.getFullYear()} –≥–æ–¥–∞`
        );
      },
      plotSelectors: function () {
        document.querySelector(
          ".calendar"
        ).innerHTML += `<div class="calendar-inner"><div class="calendar-controls">
          <div class="calendar-prev"><a href="#"><svg xmlns="http://www.w3.org/2000/svg" width="128" height="128" viewBox="0 0 128 128"><path fill="#666" d="M88.2 3.8L35.8 56.23 28 64l7.8 7.78 52.4 52.4 9.78-7.76L45.58 64l52.4-52.4z"/></svg></a></div>
          <div class="calendar-year-month">
          <div class="calendar-month-label"></div>
          <div>-</div>
          <div class="calendar-year-label"></div>
          </div>
          <div class="calendar-next"><a href="#"><svg xmlns="http://www.w3.org/2000/svg" width="128" height="128" viewBox="0 0 128 128"><path fill="#666" d="M38.8 124.2l52.4-52.42L99 64l-7.77-7.78-52.4-52.4-9.8 7.77L81.44 64 29 116.42z"/></svg></a></div>
          </div>
          <div class="calendar-today-date">–°–µ–≥–æ–¥–Ω—è: 
            ${calendarControl.calWeekDays[calendarControl.localDate.getDay()]}, 
            ${calendarControl.localDate.getDate()}, 
            ${calendarControl.calMonthName[calendarControl.localDate.getMonth()]} 
            ${calendarControl.localDate.getFullYear()}
          </div>
          <div class="calendar-body"></div></div>`;
      },
      plotDayNames: function () {
        for (let i = 0; i < calendarControl.calWeekDays.length; i++) {
          document.querySelector(
            ".calendar .calendar-body"
          ).innerHTML += `<div>${calendarControl.calWeekDays[i]}</div>`;
        }
      },
      plotDates: function () {
        document.querySelector(".calendar .calendar-body").innerHTML = "";
        calendarControl.plotDayNames();
        calendarControl.displayMonth();
        calendarControl.displayYear();
        let count = 1;
        let prevDateCount = 0;
  
        calendarControl.prevMonthLastDate = calendarControl.getPreviousMonthLastDate();
        let prevMonthDatesArray = [];
        let calendarDays = calendarControl.daysInMonth(
          calendar.getMonth() + 1,
          calendar.getFullYear()
        );
        // dates of current month
        for (let i = 1; i < calendarDays; i++) {
          if (i < calendarControl.firstDayNumber()) {
            prevDateCount += 1;
            document.querySelector(
              ".calendar .calendar-body"
            ).innerHTML += `<div class="prev-dates"></div>`;
            prevMonthDatesArray.push(calendarControl.prevMonthLastDate--);
          } else {
            document.querySelector(
              ".calendar .calendar-body"
            ).innerHTML += `<div class="number-item" data-num=${count}><a class="dateNumber" href="#">${count++}</a></div>`;
          }
        }
        //remaining dates after month dates
        for (let j = 0; j < prevDateCount + 1; j++) {
          document.querySelector(
            ".calendar .calendar-body"
          ).innerHTML += `<div class="number-item" data-num=${count}><a class="dateNumber" href="#">${count++}</a></div>`;
        }
        calendarControl.highlightToday();
        calendarControl.plotPrevMonthDates(prevMonthDatesArray);
        calendarControl.plotNextMonthDates();
      },
      attachEvents: function () {
        let prevBtn = document.querySelector(".calendar .calendar-prev a");
        let nextBtn = document.querySelector(".calendar .calendar-next a");
        let todayDate = document.querySelector(".calendar .calendar-today-date");
        let dateNumber = document.querySelectorAll(".calendar .dateNumber");
        prevBtn.addEventListener(
          "click",
          calendarControl.navigateToPreviousMonth
        );
        nextBtn.addEventListener("click", calendarControl.navigateToNextMonth);
        todayDate.addEventListener(
          "click",
          calendarControl.navigateToCurrentMonth
        );
        for (var i = 0; i < dateNumber.length; i++) {
            dateNumber[i].addEventListener(
              "click",
              calendarControl.selectDate,
              false
            );
        }
      },
      highlightToday: function () {
        let currentMonth = calendarControl.localDate.getMonth() + 1;
        let changedMonth = calendar.getMonth() + 1;
        let currentYear = calendarControl.localDate.getFullYear();
        let changedYear = calendar.getFullYear();
        if (
          currentYear === changedYear &&
          currentMonth === changedMonth &&
          document.querySelectorAll(".number-item")
        ) {
          document
            .querySelectorAll(".number-item")
            [calendar.getDate() - 1].classList.add("calendar-today");
        }
      },
      plotPrevMonthDates: function(dates){
        dates.reverse();
        for(let i=0;i<dates.length;i++) {
            if(document.querySelectorAll(".prev-dates")) {
                document.querySelectorAll(".prev-dates")[i].textContent = dates[i];
            }
        }
      },
      plotNextMonthDates: function(){
       let childElemCount = document.querySelector('.calendar-body').childElementCount;
       //7 lines
       if(childElemCount > 42 ) {
           let diff = 49 - childElemCount;
           calendarControl.loopThroughNextDays(diff);
       }

       //6 lines
       if(childElemCount > 35 && childElemCount <= 42 ) {
        let diff = 42 - childElemCount;
        calendarControl.loopThroughNextDays(42 - childElemCount);
       }

      },
      loopThroughNextDays: function(count) {
        if(count > 0) {
            for(let i=1;i<=count;i++) {
                document.querySelector('.calendar-body').innerHTML += `<div class="next-dates">${i}</div>`;
            }
        }
      },
      attachEventsOnNextPrev: function () {
        calendarControl.plotDates();
        highlightShiftsInCalendar(); // –î–æ–±–∞–≤–ª—è–µ–º –≤—ã–∑–æ–≤ –ø–æ—Å–ª–µ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –¥–∞—Ç
        calendarControl.attachEvents();
      },
      init: function () {
        calendarControl.plotSelectors();
        calendarControl.plotDates();
        calendarControl.attachEvents();
        setTimeout(() => {
        highlightShiftsInCalendar(); // ‚úÖ –¢–µ–ø–µ—Ä—å —Å–º–µ–Ω—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        }, 100);
      }
    };
	
function highlightShiftsInCalendar() {
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Å–º–µ–Ω—ã (–Ω–µ –≤—ã–∑—ã–≤–∞–µ–º loadShifts())
  const dateElements = document.querySelectorAll('.calendar-body .number-item');

  dateElements.forEach(el => {
    const day = el.dataset.num.padStart(2, '0'); // –ü—Ä–∏–≤–æ–¥–∏–º –∫ —Ñ–æ—Ä–º–∞—Ç—É "01", "02"
    const month = (calendar.getMonth() + 1).toString().padStart(2, '0');
    const year = calendar.getFullYear();
    const fullDate = `${year}-${month}-${day}`;

    // –û—á–∏—â–∞–µ–º –∫–ª–∞—Å—Å—ã –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
    el.classList.remove('shift-day', 'shift-night', 'shift-holiday-day', 'shift-holiday-night');

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–º–µ–Ω–∞ –Ω–∞ —ç—Ç—É –¥–∞—Ç—É
    const shift = shifts.find(s => s.date === fullDate);
    if (shift) {
      if (shift.shiftType === 'day') el.classList.add('shift-day');
      if (shift.shiftType === 'night') el.classList.add('shift-night');
      if (shift.shiftType === 'holidayDay') el.classList.add('shift-holiday-day');
      if (shift.shiftType === 'holidayNight') el.classList.add('shift-holiday-night');
    }
  });
}

	
    calendarControl.init();
  }
  
  const calendarControl = new CalendarControl();

</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
 // –∏–º–ø–æ—Ä—Ç —Å–º–µ–Ω
   document.addEventListener("DOMContentLoaded", () => {
  const fileInput = document.getElementById("uploadSchedule");
  const employeeSelect = document.getElementById("employeeSelect");
  const importButton = document.getElementById("importShifts");

  let employees = []; // –°–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
  let scheduleData = {}; // –î–∞–Ω–Ω—ã–µ –∏–∑ ODS

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
  function updateEmployeeSelect() {
    employeeSelect.innerHTML = employees
      .map(name => `<option value="${name}">${name}</option>`)
      .join("");
  }

  // –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ ODS-—Ñ–∞–π–ª–∞
  fileInput.addEventListener("change", (event) => {
    const file = event.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.readAsArrayBuffer(file);
    reader.onload = function (e) {
      const data = new Uint8Array(e.target.result);
      const workbook = XLSX.read(data, { type: "array" });

      // –ß–∏—Ç–∞–µ–º –ø–µ—Ä–≤—ã–π –ª–∏—Å—Ç
      const sheetName = workbook.SheetNames[0];
      const sheet = XLSX.utils.sheet_to_json(workbook.Sheets[sheetName], { header: 1 });

      if (!sheet || sheet.length === 0) {
        alert("–û—à–∏–±–∫–∞: –ø—É—Å—Ç–æ–π —Ñ–∞–π–ª –∏–ª–∏ –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç!");
        return;
      }

      // ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∫–æ–¥ –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
      employees = sheet
        .map(row => row[0]?.trim())  // –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
        .filter(name => name && !name.startsWith("–§–ò–û") && !name.startsWith("–ö–æ–ª-–≤–æ –ª–∏–Ω–∏–π")); // –£–±–∏—Ä–∞–µ–º –Ω–µ–Ω—É–∂–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏

      console.log("–ù–∞–π–¥–µ–Ω–Ω—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏:", employees);

      if (employees.length === 0) {
        alert("–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ —Ñ–∞–π–ª–µ!");
        return;
      }

      // –ó–∞–ø–æ–ª–Ω—è–µ–º –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫
      updateEmployeeSelect();

      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
      scheduleData = sheet;
      alert("–§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω! –í—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ '–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å'");
    };
  });

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å"
  importButton.addEventListener("click", () => {
    if (!scheduleData.length) {
      alert("–°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ ODS-—Ñ–∞–π–ª!");
      return;
    }

    const selectedEmployee = employeeSelect.value;
    if (!selectedEmployee) {
      alert("–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞!");
      return;
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞, –µ—Å—Ç—å –ª–∏ —Ç–∞–∫–æ–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –≤ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    const employeeRow = scheduleData.find(row => row[0] === selectedEmployee);
    if (!employeeRow) {
      alert("–ù–µ –Ω–∞–π–¥–µ–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞.");
      return;
    }

    // –ü–∞—Ä—Å–∏–º —Å–º–µ–Ω—ã (–∏—â–µ–º "–î" –∏ "–ù")
    const newShifts = [];
    const yearMonth = "2025-02"; // –¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü (–º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º)

    for (let day = 1; day < employeeRow.length; day++) {
      const shift = employeeRow[day];
      if (shift === "–î" || shift === "–ù") {
        newShifts.push({
          id: Date.now() + day,
          name: shift === "–î" ? "–î–µ–Ω—å" : "–ù–æ—á—å",
          date: `${yearMonth}-${String(day).padStart(2, "0")}`,
          startTime: shift === "–î" ? "08:00" : "20:00",
          shiftType: shift === "–î" ? "day" : "night",
          remindBefore: 30,
          isDone: false
        });
      }
    }

    if (!newShifts.length) {
      alert("–°–º–µ–Ω—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã!");
      return;
    }

    // –î–æ–±–∞–≤–ª—è–µ–º —Å–º–µ–Ω—ã –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º
    shifts = [...shifts, ...newShifts];
    saveShiftsToLocalStorage();
    renderShiftsTable();
    highlightShiftsInCalendar();

    alert("–°–º–µ–Ω—ã –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!");
  });
});
</script>
<script>
// üìå –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è iOS (iPhone)
document.addEventListener("DOMContentLoaded", () => {
    // 1Ô∏è‚É£ –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    if ("Notification" in window) {
        if (Notification.permission === "default") {
            Notification.requestPermission().then(permission => {
                if (permission === "granted") {
                    console.log("‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω—ã!");
                } else {
                    console.warn("‚ö†Ô∏è –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∑–∞–ø—Ä–µ—â–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.");
                }
            });
        }
    }

    checkShiftReminders(); // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —Å–º–µ–Ω
});

function checkShiftReminders() {
    loadShifts();
    if (!shifts.length) return;

    let now = new Date();
    shifts.forEach(shift => {
        let shiftDate = new Date(shift.date + "T" + shift.startTime);
        let timeDiff = shiftDate - now;

        if (timeDiff > 0 && timeDiff <= 1800000) { // –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∑–∞ 30 –º–∏–Ω—É—Ç
            new Notification("–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ —Å–º–µ–Ω–µ", {
                body: `üìÖ –í–∞—à–∞ —Å–º–µ–Ω–∞ (${shift.shiftType === "night" ? "–ù–æ—á–Ω–∞—è" : "–î–Ω–µ–≤–Ω–∞—è"}) —Å–∫–æ—Ä–æ –Ω–∞—á–Ω—ë—Ç—Å—è!`,
                icon: "https://cdn-icons-png.flaticon.com/512/2983/2983767.png",
                vibrate: [200, 100, 200]
            });
        }
    });

    // 3Ô∏è‚É£ –ü–æ–≤—Ç–æ—Ä—è–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç (600000 –º—Å) –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –±–∞—Ç–∞—Ä–µ–∏
    setTimeout(checkShiftReminders, 600000);
}

// ‚úÖ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É (—ç–∫–æ–Ω–æ–º–∏—è –±–∞—Ç–∞—Ä–µ–∏)
document.addEventListener("visibilitychange", () => {
    if (document.visibilityState === "visible") {
        checkShiftReminders();
    }
});
</script>
<script src="script.js"></script>
<script src="sync.js"></script>
</body>
</html>
